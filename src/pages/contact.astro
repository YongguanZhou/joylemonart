---
import BaseLayout from "../layouts/BaseLayout.astro";
import { SITE } from "../site";

const raw = SITE.contact;

// 兼容你 site.ts 里带前缀的值
const address = raw.address.replace(/^\s*Address:\s*/i, "").trim();
const email = raw.email.replace(/^\s*E-?mail:\s*/i, "").trim();
const phone = raw.phone.replace(/^\s*Tel:\s*/i, "").trim();

const telHref = "+1" + phone.replace(/\D/g, "");
const mapSrc = `https://www.google.com/maps?q=${encodeURIComponent(address)}&output=embed`;
---

<BaseLayout title={`Contact | ${SITE.title}`} description={SITE.description}>
  <main class="page-home">
    <section class="contact-wrap w-1-c">
      <div class="contact-grid">
        <!-- 左侧：联系方式 + 底部图片 -->
        <div class="contact-left">
          <h1 class="contact-title">联系我们</h1>

          <div class="contact-item">
            <div class="contact-label">E-mail:</div>
            <div class="contact-value">
              <a class="contact-link" href={`mailto:${email}`}>{email}</a>
            </div>
          </div>

          <div class="contact-item">
            <div class="contact-label">Tel:</div>
            <div class="contact-value">
              <a class="contact-link" href={`tel:${telHref}`}>{phone}</a>
            </div>
          </div>

          <div class="contact-item">
            <div class="contact-label">Address:</div>
            <div class="contact-value">{address}</div>
          </div>

          <div class="contact-image">
            <img src="/images/contact.png" alt="contact" loading="lazy" />
          </div>
        </div>

        <!-- 右侧：地图 -->
        <div class="contact-right">
          <div class="map-shell">
            <iframe
              src={mapSrc}
              title="Google Map"
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
              allowfullscreen
            ></iframe>
          </div>
        </div>
      </div>
    </section>

    <style>
      {`
      /* ========= Desktop / Base ========= */
      .contact-wrap{
        max-width: 1300px;
        margin: 0 auto;
        padding: 28px 12px 36px;
      }

      .contact-grid{
        display: grid;
        grid-template-columns: 0.9fr 1.1fr;
        gap: 36px;
        align-items: start;
      }

      .contact-left, .contact-right{
        min-width: 0;
      }

      .contact-title{
        margin: 0 0 12px;
        font-size: 30px;
        font-weight: 800;
        letter-spacing: 1px;
      }

      .contact-item{
        margin: 14px 0;
      }

      .contact-label{
        font-size: 22px;
        font-weight: 800;
        margin-bottom: 6px;
      }

      .contact-value{
        font-size: 22px;
        line-height: 1.35;
        word-break: break-word;
      }

      .contact-link{
        color: inherit;
        text-decoration: none;
      }
      .contact-link:hover{
        text-decoration: underline;
      }

      .contact-image{
        margin-top: 26px;
        max-width: 500px;
      }
      .contact-image img{
        width: 100%;
        display: block;
        height: auto;
      }

      .map-shell{
        width: 100%;
        height: 520px;
        border-radius: 12px;
        overflow: hidden;
        border: 1px solid rgba(0,0,0,.12);
        background: #fff;
        position: relative;
      }
      .map-shell iframe{
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        border: 0;
        display: block;
        max-width: none;
        transform: none;
      }

      /* ========= Tablet & below: 2列 -> 1列 ========= */
      @media (max-width: 860px){
        .contact-grid{
          grid-template-columns: 1fr;
          gap: 18px;
        }
        .map-shell{
          height: 420px;
        }
      }

      /* ========= Mobile typography (你要的：联系方式字变小) ========= */
      @media (max-width: 640px){
        .contact-title{
          font-size: 15px;
          margin-bottom: 8px;
          letter-spacing: 0.5px;
        }

        .contact-item{
          margin: 10px 0;
        }

        .contact-label{
          font-size: 15px;
          margin-bottom: 4px;
          font-weight: 800;
        }

        .contact-value{
          font-size: 14px;
          line-height: 1.35;
        }

        .contact-image{
          margin-top: 16px;
          max-width: 420px;
        }

        .map-shell{
          height: 360px;
          border-radius: 10px;
        }
      }

      /* ========= Small phones ========= */
      @media (max-width: 380px){
        .contact-title{ font-size: 20px; }
        .contact-label{ font-size: 14px; }
        .contact-value{ font-size: 13px; }
        .map-shell{ height: 320px; }
      }
      `}
    </style>
  </main>
</BaseLayout>
